model EMVendors {
  id                BigInt    @id @default(autoincrement())
  userId            BigInt    @map("user_id")
  shopName          String    @unique @map("shop_name") @db.VarChar(255)
  shopSlug          String    @unique @map("shop_slug") @db.VarChar(255)
  shopLogoUrl       String?   @map("shop_logo_url") @db.VarChar(500)
  shopBannerUrl     String?   @map("shop_banner_url") @db.VarChar(500)
  legalBusinessName String?   @map("legal_business_name") @db.VarChar(255)
  taxId             String?   @map("tax_id") @db.VarChar(100)
  businessLicense   String?   @map("business_license") @db.VarChar(100)
  status            String?   @default("pending") @db.VarChar(20)
  commissionRate    Decimal?  @default(10.00) @map("commission_rate") @db.Decimal(5, 2)
  ratingAverage     Decimal?  @default(0) @map("rating_average") @db.Decimal(3, 2)
  totalReviews      Int?      @default(0) @map("total_reviews")
  totalProducts     Int?      @default(0) @map("total_products")
  totalSales        Int?      @default(0) @map("total_sales")
  joinedAt          DateTime? @default(now()) @map("joined_at") @db.Timestamp
  approvedAt        DateTime? @map("approved_at") @db.Timestamp
  createdAt         DateTime? @default(now()) @map("created_at") @db.Timestamp
  updatedAt         DateTime? @default(now()) @map("updated_at") @db.Timestamp
  deletedAt         DateTime? @map("deleted_at") @db.Timestamp

  user User @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  translations      EMVendorTranslations[]
  addresses         EMVendorAddresses[]
  bankAccounts      EMVendorBankAccounts[]
  payouts           EMVendorPayouts[]
  transactions      EMVendorTransactions[]
  followers         EMVendorFollowers[]
  products          EMProducts[]
  cartItems         EMCartItems[]
  coupons           EMCoupons[]
  vouchers          EMVouchers[]
  shippingMethods   EMShippingMethods[]
  shippingZones     EMShippingZones[]
  chatConversations EMChatConversations[]
  disputes          EMDisputes[]
  activityLogs      EMActivityLogs[]
  inventoryLogs     EMInventoryLogs[]
  productViews      EMProductViewLogs[]
  subscriptions     EMVendorSubscriptions[]
  banners           EMBanners[]
  vendorReports     EMVendorReports[]
  reviews           EMReviews[]
  reviewReplies     EMReviewReplies[]
  orderGroups       EMOrderVendorGroups[]
  orderItems        EMOrderItems[]
  shipments         EMShipments[]

  @@map("EMVendors")
  @@index([userId])
  @@index([shopSlug])
  @@index([status])
  @@index([ratingAverage])
}

model EMVendorTranslations {
  id              BigInt  @id @default(autoincrement())
  vendorId        BigInt  @map("vendor_id")
  languageId      Int     @map("language_id")
  shopDescription String? @map("shop_description") @db.Text
  shopPolicy      String? @map("shop_policy") @db.Text
  returnPolicy    String? @map("return_policy") @db.Text

  vendor   EMVendors   @relation(fields: [vendorId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  language EMLanguages @relation(fields: [languageId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@map("EMVendorTranslations")
  @@unique([vendorId, languageId])
}

model EMVendorAddresses {
  id           BigInt    @id @default(autoincrement())
  vendorId     BigInt    @map("vendor_id")
  addressType  String?   @map("address_type") @db.VarChar(20)
  isDefault    Boolean?  @default(false) @map("is_default")
  contactName  String?   @map("contact_name") @db.VarChar(200)
  phone        String?   @db.VarChar(20)
  addressLine1 String    @map("address_line1") @db.VarChar(255)
  addressLine2 String?   @map("address_line2") @db.VarChar(255)
  city         String    @db.VarChar(100)
  state        String?   @db.VarChar(100)
  postalCode   String    @map("postal_code") @db.VarChar(20)
  country      String    @db.VarChar(2)
  latitude     Decimal?  @db.Decimal(10, 8)
  longitude    Decimal?  @db.Decimal(11, 8)
  operatingHours Json?   @map("operating_hours")
  createdAt    DateTime? @default(now()) @map("created_at") @db.Timestamp
  updatedAt    DateTime? @default(now()) @map("updated_at") @db.Timestamp

  vendor EMVendors @relation(fields: [vendorId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@map("EMVendorAddresses")
  @@index([vendorId])
  @@index([vendorId, isDefault])
}

model EMVendorBankAccounts {
  id                BigInt    @id @default(autoincrement())
  vendorId          BigInt    @map("vendor_id")
  bankName          String    @map("bank_name") @db.VarChar(255)
  accountHolderName String    @map("account_holder_name") @db.VarChar(255)
  accountNumber     String    @map("account_number") @db.VarChar(100)
  bankCode          String?   @map("bank_code") @db.VarChar(50)
  branchName        String?   @map("branch_name") @db.VarChar(255)
  isDefault         Boolean?  @default(false) @map("is_default")
  isVerified        Boolean?  @default(false) @map("is_verified")
  createdAt         DateTime? @default(now()) @map("created_at") @db.Timestamp
  updatedAt         DateTime? @default(now()) @map("updated_at") @db.Timestamp

  vendor  EMVendors         @relation(fields: [vendorId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  payouts EMVendorPayouts[]

  @@map("EMVendorBankAccounts")
  @@index([vendorId])
}

model EMVendorPayouts {
  id                   BigInt    @id @default(autoincrement())
  vendorId             BigInt    @map("vendor_id")
  bankAccountId        BigInt?   @map("bank_account_id")
  payoutNumber         String    @unique @map("payout_number") @db.VarChar(50)
  amount               Decimal   @db.Decimal(10, 2)
  currency             String?   @default("USD") @db.VarChar(3)
  status               String    @db.VarChar(20)
  periodStart          DateTime  @map("period_start") @db.Timestamp
  periodEnd            DateTime  @map("period_end") @db.Timestamp
  transactionReference String?   @map("transaction_reference") @db.VarChar(255)
  notes                String?   @db.Text
  processedAt          DateTime? @map("processed_at") @db.Timestamp
  createdAt            DateTime? @default(now()) @map("created_at") @db.Timestamp
  updatedAt            DateTime? @default(now()) @map("updated_at") @db.Timestamp

  vendor      EMVendors             @relation(fields: [vendorId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  bankAccount EMVendorBankAccounts? @relation(fields: [bankAccountId], references: [id], onDelete: SetNull, onUpdate: Cascade)
  transactions EMVendorTransactions[]

  @@map("EMVendorPayouts")
  @@index([vendorId])
  @@index([status])
  @@index([createdAt])
}

model EMVendorTransactions {
  id              BigInt    @id @default(autoincrement())
  vendorId        BigInt    @map("vendor_id")
  orderId         BigInt?   @map("order_id")
  payoutId        BigInt?   @map("payout_id")
  transactionType String    @map("transaction_type") @db.VarChar(50)
  amount          Decimal   @db.Decimal(10, 2)
  endingBalance   Decimal   @map("ending_balance") @db.Decimal(10, 2)
  notes           String?   @db.Text
  createdAt       DateTime? @default(now()) @map("created_at") @db.Timestamp

  vendor EMVendors        @relation(fields: [vendorId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  order  EMOrders?        @relation(fields: [orderId], references: [id], onDelete: SetNull, onUpdate: Cascade)
  payout EMVendorPayouts? @relation(fields: [payoutId], references: [id], onDelete: SetNull, onUpdate: Cascade)

  @@map("EMVendorTransactions")
  @@index([vendorId])
  @@index([vendorId, transactionType])
  @@index([orderId])
  @@index([payoutId])
}

model EMVendorFollowers {
  id        BigInt    @id @default(autoincrement())
  vendorId  BigInt    @map("vendor_id")
  userId    BigInt    @map("user_id")
  createdAt DateTime? @default(now()) @map("created_at") @db.Timestamp

  vendor EMVendors @relation(fields: [vendorId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  user   User      @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@map("EMVendorFollowers")
  @@unique([vendorId, userId])
  @@index([userId])
}

model EMVendorSubscriptions {
  id             BigInt    @id @default(autoincrement())
  vendorId       BigInt    @map("vendor_id")
  planName       String    @map("plan_name") @db.VarChar(50)
  monthlyFee     Decimal?  @default(0) @map("monthly_fee") @db.Decimal(10, 2)
  productLimit   Int?      @map("product_limit")
  commissionRate Decimal   @map("commission_rate") @db.Decimal(5, 2)
  features       Json?
  startsAt       DateTime  @map("starts_at") @db.Timestamp
  endsAt         DateTime  @map("ends_at") @db.Timestamp
  isActive       Boolean?  @default(true) @map("is_active")
  autoRenew      Boolean?  @default(true) @map("auto_renew")
  createdAt      DateTime? @default(now()) @map("created_at") @db.Timestamp

  vendor EMVendors @relation(fields: [vendorId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@map("EMVendorSubscriptions")
  @@index([vendorId])
  @@index([vendorId, isActive])
  @@index([endsAt])
}

model EMVendorReports {
  id          BigInt    @id @default(autoincrement())
  vendorId    BigInt    @map("vendor_id")
  userId      BigInt?   @map("user_id")
  reason      String    @db.VarChar(50)
  description String    @db.Text
  status      String?   @default("pending") @db.VarChar(20)
  adminNotes  String?   @map("admin_notes") @db.Text
  resolvedAt  DateTime? @map("resolved_at") @db.Timestamp
  createdAt   DateTime? @default(now()) @map("created_at") @db.Timestamp

  vendor EMVendors @relation(fields: [vendorId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  user   User?     @relation(fields: [userId], references: [id], onDelete: SetNull, onUpdate: Cascade)

  @@map("EMVendorReports")
  @@index([vendorId])
  @@index([userId])
  @@index([status])
}
